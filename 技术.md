1. agent 框架：

   * langchain （langgraph）:生态完整，支持图状工作流，适合复杂多步骤任务
   * crewAI: multi agent， 每个agent 明确分工，多专家协同类型工作
   * AutoGen: 微软出品，对话式多agent系统很强。
   * OpenAI Agents SDK: 轻量，支持100多种不同的大模型，内置追踪和安全防护。适合实际生产环境项目
   * semantic Kernel: 企业级应用，与微软生态深度集成，在安全性和合规性方面做得比较到位
   * Haystack：问答系统或者知识库检索。
2. langgraph.graph 中的StateGraph ：

   * [LangGraph](https://www.langchain.com/langgraph)
   * 作用辅助构建工作流
   * 设置节点+边/条件边--> 完整的状态转换控制图
   * agent node
   * tool node
   * edge 三类start normal conditional
   * stream--需要构建好图以及条件逻辑后，通过compile
3. 包含decision 部分
4. 包含实时反馈部分
5. Trading agent 的项目结构：

   * agents ：agent node ， 每个node 用的什么大模型quick +用户选择，并绑定工具tool node。全部都是一样的，具体的工具和模型不一样。

     1. 分析师

        1. fundamentals_analyst 基本面分析agent，包含基本的prompt

           1. 绑定的get_fundamentals，get_balance_sheet，get_cashflow，get_income_statement
           2. 获取指定股票的基本面，资产负债表，现金流，损益表
           3. tool 绑定的是一个函数，具体是调用request /对应的包 去对应的api 获取相应的信息
        2. market_analyst 市场分析agent。让agent 选择至多8个最相关的指标

           1. 绑定的get_stock_data，get_indicators， 股票所有数据和指定指标
        3. news_analyst 新闻分析agent。

           1. get_news，get_global_news获取特定公司或者目标的新闻，以及获取宏观经济的新闻。
        4. social_media 社交媒体舆情agent，获取公司在社交媒体上的新闻，帖子，和公众情绪

           1. get_news 获取特定公司或者目标的新闻
     2. bear bull 研究

        1. bear：获取之前的市场数据报告，社交媒体舆情报告，新闻报告，基本面报告，以及对话历史，论证看空。强调风险、挑战和负面指标。
        2. bull：获取之前的市场数据报告，社交媒体舆情报告，新闻报告，基本面报告，以及对话历史，论证看涨。强调风险、挑战和负面指标。
        3. research_manager：

           1. 对辩论进行批判性评估，并做出明确决定。为交易员制定详细的投资计划。内容应包括：建议：一个明确立场，并有最具说服力的论据支持。理由：解释为什么这些论据导致您的结论。战略行动：实施建议的具体步骤。
     3. 风险管理

        1. aggresive:
           1. 获取之前的市场数据报告，社交媒体舆情报告，新闻报告，基本面报告，以及交易投资计划，过往的风险讨论历史。通过质疑和批判 保守及中立立场，来为交易者的决策（交易投资计划）建立一个有说服力的论点，从而展示为什么你的高回报视角是最佳前进路径。
        2. conservative：积极反驳风险型和中立型分析师的论点，指出他们的观点可能忽略的潜在威胁或未能优先考虑可持续性问题。为交易员的决策构建一个支持低风险调整的有力论据
        3. neutral：反驳风险分析师和安全分析师，指出每种观点可能过于乐观或过于谨慎的地方。使用以下数据来源的见解来支持一种温和、可持续的策略，以调整交易员的决策。
        4. risk manager: 评估三位风险分析师之间的辩论，并根据辩论修改确定交易者的最佳行动方案：明确的建议：买入、卖出或持有。
     4. 交易员：

        1. 获取当前的市场数据报告，社交媒体舆情报告，新闻报告，基本面报告，以及拟投资计划，提供具体的买入、卖出或持有建议
   * dataflow：具体的tool 的方法，包含怎么调用api的工具

     * 各个方法跟调用的方法/url 之间的对应关系
     * alpha vantage 开头的文件，根据alpha vantage 的url 去request  get一个response
     * Google的两个文件，结合在一起，获取指定日期之间的搜索。也是request  根据url爬取
     * openai 使用 openai 用prompt 指示agent去检索相关的信息如基本面，股票数据新闻舆情，全球经济新闻等
     * y_finance 和yfin_utils 两个文件结合在一起，用官方给的包yfinance在线获取股票数据。如实时股价数据，资产负债表，现金流表，利润表，在线内部交易数据等。技术指标的计算(用的stockstats包中的triggers )
     * interface 辅助工具，将tool 函数，与对应调用的alpha vantage 或者google等之间对应起来。
     * utils 辅助工具，获取日期，为函数增加装饰器，存储数据
     * local 辅助工具，从已有的获取到的文件中读取数据，筛选出固定时间段的数据。
     * reddit_utils 辅助工具，从已有的reddit 数据中加载数据
     * stockstats_utils：
   * graph：

     1. trading graph, 核心类，包含整个工作流的形状（初始化各个node, 初始化控制，初始化reflector, 初始化 最终的信号处理类）
     2. setup 根据用户的参数+trading graph 的形状，添加节点与边到lang graph stategraph 的工作流中去，也就是能按照用户指定构建工作流
     3. conditional_logic： 判断条件类。各个函数接收当前的状态，返回是否要跳转的信号，以及跳转到哪的信号
     4. propagation：初始化的时候，整体消息结构输入的控制。--结构化通信
     5. reflection: 类。将loss 插入到各个agent 的memory 中
     6. signal processing: 从最后的消息内容中获取decision 只是一个单一的 hold sold buy
6. 实现1， 能闭环更新现状

   * 需要一个/多个函数，控制调用:分析（traing graph 设置到当前时间）->decision（signal processing）->trade(新写一个函数，根据decision 去操作)-->return loss （调用tool node中跟价格相关的api 获取第二次操作时的价格，计算loss）--> update memory(relection 类)-->循环
   * 怎么返回价格： 修改 agents node 中的prompt 即可，现在的提示是根据现金流（这个结构化通信里面有，但是没有让用户提供，这里也需要找到，改，看到过，忘记在哪了，应该是跟prompt 关联的里面）各种当前的状况+只分析股票的prompt, 将prompt 修改让返回，（hold）(sell : volumn)(buy,volumn)
   * 怎么分析整个市场，这个地方的变动最大了。
     1. 消息结构，要变成分析什么市场。
     2. 这里面的调用tool node 可能需要修改，还没有仔细查看。或许变成循环调用？但是更耗时，最好是一次性运行提供。这里直观感觉很麻烦
     3. prompt 这里提示肯定要改，参数的placehold也要对应的修改，这个部分不难。
